<!doctype html>
<html lang="zh-cn">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="renderer" content="webkit">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">
<title>jquery qrcode</title>
<style>
#button{margin:20px auto;display:block;padding:10px;}
#qrcode{margin:0 auto;width:256px;height:256px;padding:15px;border:1px solid #f5f5f5;border-color:hsla(0, 0%, 0%, 0);
    box-shadow:0 0 5px 5px hsla(110, 30%, 40%, .3);}
</style>
<script src="../../src/jquery-2.1.3.min.js"></script>
<script src="src/jquery.qrcode.min.js"></script>
<script src="src/utf.js"></script>
</head>
<body>
    <button type="button" id="button">生成二维码</button>
    <div id="qrcode"></div>

    <script>
        (function(w, d) {

            function supportCanvas() {
                try {
                    document.createElement("canvas").getContext("2d");
                    return true;
                } catch(e) {
                    return false;
                }
            }

            var text = utf16to8(Math.ceil(Math.random() * 10e+5 + Date.now()) + "");
            console.log(text);

            $("#qrcode").qrcode({
                render: supportCanvas() ? "canvas" : "table",
                width: 256,
                height: 256,
                background: "#ffffff",
                foreground: "#000000",
                text: text
            });


            /*$("#button").click(function() {
                if($("#qrcode").attr("data-qrcode") !== "1") {
                    $("#qrcode").qrcode({
                        render: supportCanvas() ? "canvas" : "table",
                        width: 256,
                        height: 256,
                        background: "#ffffff",
                        foreground: "#000000",
                        text: utf16to8(location.href)
                    }).attr("data-qrcode", "1");
                }
            });*/
        }(window, document));
    </script>
</body>
</html>